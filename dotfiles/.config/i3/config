# i3 config file (v4)
# https://i3wm.org/docs/userguide.html

# mod key
set $mod Mod1
set $super Mod4

# font
font pango:hackgen 12

# direction (vim)
set $left h
set $down j
set $up k
set $right l

# change focus window
bindsym $mod+$left focus left
bindsym $mod+$down focus down
bindsym $mod+$up focus up
bindsym $mod+$right focus right

# move focused window
bindsym $mod+shift+$left move left
bindsym $mod+shift+$down move down
bindsym $mod+shift+$up move up
bindsym $mod+shift+$right move right

# fullscreen
bindsym $mod+f fullscreen toggle

# scratchpad
bindsym $mod+semicolon scratchpad show
bindsym $mod+shift+semicolon move scratchpad
# for custom keyboard
bindsym $mod+minus scratchpad show
bindsym $mod+shift+minus move scratchpad

# kill
bindsym $mod+q kill
bindsym --release button2 kill

# restart
bindsym $mod+shift+r restart

# workspace
set $ws1 1:
set $ws2 2:
set $ws3 3:
set $ws4 4:
set $ws5 5:
set $ws6 6:
set $ws7 7:
set $ws8 8:
set $ws9 9:
set $ws10 10:

bindsym $mod+comma workspace prev
bindsym $mod+period workspace next
bindsym $mod+1 workspace number $ws1
bindsym $mod+2 workspace number $ws2
bindsym $mod+3 workspace number $ws3
bindsym $mod+4 workspace number $ws4
bindsym $mod+5 workspace number $ws5
bindsym $mod+6 workspace number $ws6
bindsym $mod+7 workspace number $ws7
bindsym $mod+8 workspace number $ws8
bindsym $mod+9 workspace number $ws9
bindsym $mod+10 workspace number $ws10

bindsym $mod+shift+comma move container to workspace prev
bindsym $mod+shift+period move container to workspace next
bindsym $mod+shift+1 move container to workspace number $ws1
bindsym $mod+shift+2 move container to workspace number $ws2
bindsym $mod+shift+3 move container to workspace number $ws3
bindsym $mod+shift+4 move container to workspace number $ws4
bindsym $mod+shift+5 move container to workspace number $ws5
bindsym $mod+shift+6 move container to workspace number $ws6
bindsym $mod+shift+7 move container to workspace number $ws7
bindsym $mod+shift+8 move container to workspace number $ws8
bindsym $mod+shift+9 move container to workspace number $ws9
bindsym $mod+shift+10 move container to workspace number $ws10

# system
set $system "system [q: poweroff, r: reboot, s: suspend, l: lock, L: logout]"
bindsym $mod+shift+q mode $system
mode $system {
  bindsym q exec --no-startup-id "systemctl poweroff"; mode "default"
  bindsym r exec --no-startup-id "systemctl reboot"; mode "default"
  bindsym s exec --no-startup-id "systemctl suspend"; mode "default"
  bindsym l exec --no-startup-id ~/.config/i3/i3lock-color.sh; mode "default"
  bindsym L exec --no-startup-id "i3-msg exit"; mode "default"
  bindsym Escape mode "default"
}

# layout (style)
set $layout "layout [v: split v, h: split h, s: stack, t: tab, e: toggle, f: float, p: parent, c: child]"
bindsym $mod+s mode $layout
mode $layout {
  bindsym v split v; mode "default"
  bindsym h split h; mode "default"
  bindsym s layout stacking; mode "default"
  bindsym t layout tabbed; mode "default"
  bindsym e layout toggle split; mode "default"
  bindsym f floating toggle; mode "default"
  bindsym p focus parent; mode "default"
  bindsym c focus child; mode "default"
  bindsym Escape mode "default"
}

# audio
set $audio "audio [space: play-pause, m0-9: vol, <: prev, >: next, j: voldn, k: volup, l: forward, h: backward]"
set $setvol pactl set-sink-volume @DEFAULT_SINK@
bindsym $mod+a mode $audio
mode $audio {
  bindsym m exec --no-startup-id $setvol 0%
  bindsym 1 exec --no-startup-id $setvol 10%
  bindsym 2 exec --no-startup-id $setvol 20%
  bindsym 3 exec --no-startup-id $setvol 30%
  bindsym 4 exec --no-startup-id $setvol 40%
  bindsym 5 exec --no-startup-id $setvol 50%
  bindsym 6 exec --no-startup-id $setvol 60%
  bindsym 7 exec --no-startup-id $setvol 70%
  bindsym 8 exec --no-startup-id $setvol 80%
  bindsym 9 exec --no-startup-id $setvol 90%
  bindsym 0 exec --no-startup-id $setvol 100%
  bindsym space exec --no-startup-id playerctl play-pause
  bindsym shift+comma exec --no-startup-id playerctl previous
  bindsym shift+period exec --no-startup-id playerctl next
  bindsym h exec --no-startup-id playerctl position 5-
  bindsym l exec --no-startup-id playerctl position 5+
  bindsym j exec --no-startup-id playerctl volume 0.1-
  bindsym k exec --no-startup-id playerctl volume 0.1+
  bindsym Escape mode "default"
}

# resize
bindsym $mod+r mode "resize"
set $resize_init 5 px or 5 ppt
mode "resize" {
  bindsym $left resize shrink width $resize_init
  bindsym $down resize grow height $resize_init
  bindsym $up resize shrink height $resize_init
  bindsym $right resize grow width $resize_init
  bindsym Escape mode "default"
}

# screenshot
set $capture "screen shot"
set $pic_dir ~/pic/screenshot
set $delay 0.01
set $date $(date +%Y%m%d%H%M%S)
bindsym $mod+shift+s mode $capture
mode  $capture {
  bindsym a exec --no-startup-id maim -d $delay | xclip -selection clipboard -t image/png;  mode "default"
  bindsym s exec --no-startup-id maim -s | xclip -selection clipboard -t image/png;  mode "default"
  bindsym shift+a exec --no-startup-id maim -d $delay $pic_dir/$date.png;  mode "default"
  bindsym shift+s exec --no-startup-id maim -s $pic_dir/$date.png;  mode "default"
  bindsym Escape mode "default"
}

# notify
bindsym $mod+n exec --no-startup-id dunstctl close-all

# insert
bindsym $mod+i mode "insert"
mode  "insert" {
  bindsym Escape mode "default"
}

# color
set $black #2E3440
set $gray #4C566A
set $white #ECEFF4
set $blue #81A1C1
set $red #BF616A
set $yellow #EBCB8B

# class                  border backgr  text   indicator child_border
client.focused          $black $gray   $white $yellow   $blue
client.unfocused        $black $black  $white $yellow   $blue
client.focused_inactive $black $black  $white $yellow   $blue
client.placeholder      $black $black  $white $yellow   $blue
client.urgent           $black $black  $red   $yellow   $blue
client.background       $black

# statusbar
bar {
  status_command i3status
  strip_workspace_numbers yes
  tray_output none
  colors {
    separator  $black
    background $black
    statusline $white
    focused_workspace  $black $black $blue
    active_workspace   $black $black $gray
    inactive_workspace $black $black $gray
    urgent_workspace   $black $black $red
    binding_mode       $black $black $blue
  }
}

bar {
  status_command i3status
  strip_workspace_numbers yes
  mode hide
  modifier $super
  colors {
    separator  $black
    background $black
    statusline $white
    focused_workspace  $black $black $blue
    active_workspace   $black $black $gray
    inactive_workspace $black $black $gray
    urgent_workspace   $black $black $red
    binding_mode       $black $black $blue
  }
}

# misc
gaps inner 15
focus_follows_mouse no
default_border none

# autostart
exec_always --no-startup-id (pgrep greenclip && pkill greenclip); greenclip daemon
exec_always --no-startup-id (pgrep redshift && pkill redshift); redshift -b 1.0:0.6 -t 5000:3000 -l 36:140 -r
exec_always --no-startup-id xset r rate 180 50
exec --no-startup-id dunst -config ~/.config/dunst/dunstrc
exec --no-startup-id fcitx5
exec --no-startup-id megasync
exec --no-startup-id nm-applet
exec --no-startup-id picom -b
exec --no-startup-id unclutter -idle 1 -root
exec --no-startup-id ~/.fehbg

exec --no-startup-id wezterm
exec --no-startup-id vivaldi-stable
exec --no-startup-id discord

# app shortcut
bindsym $mod+Return exec --no-startup-id wezterm
bindsym $mod+space exec --no-startup-id rofi -show run
bindsym $mod+w exec --no-startup-id rofi -show window
bindsym $mod+c exec --no-startup-id rofi -modi "clipboard:greenclip print" -show clipboard
bindsym $mod+shift+c exec --no-startup-id ~/bin/snippets.sh
# bindsym $mod+d exec --no-startup-id rofi -show calc -modi calc -no-show-match -no-sort
# bindsym $mod+e exec --no-startup-id rofi -modi emoji -show emoji
bindsym $mod+shift+b exec --no-startup-id pkill -USR1 '^redshift$' # toggle enable/dsiable redshift

# assign window to workspace
for_window [class="^discord$"] move --no-auto-back-and-forth to workspace $ws1
for_window [class="^Vivaldi-stable$"] move --no-auto-back-and-forth to workspace $ws2
for_window [class="^Vivaldi-stable$" title="^LINE - Vivaldi$"] move --no-auto-back-and-forth to workspace $ws1
